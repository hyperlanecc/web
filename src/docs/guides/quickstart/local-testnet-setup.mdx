---
title: "æœ¬åœ°è®¾ç½®ï¼šåœ¨ Anvil èŠ‚ç‚¹é—´å‘é€æ¶ˆæ¯"
description: "æœ¬æŒ‡å—å°†å¼•å¯¼æ‚¨ä½¿ç”¨ Hyperlane CLI åœ¨ä¸¤ä¸ªæœ¬åœ° Anvil èŠ‚ç‚¹ä¹‹é—´å‘é€è·¨é“¾æ¶ˆæ¯ã€‚"
---

## å‰ç½®æ¡ä»¶[â€‹](#prerequisites "ç›´æ¥é“¾æ¥åˆ°å‰ç½®æ¡ä»¶")

- **[Hyperlane CLI](https://docs.hyperlane.xyz/docs/reference/developer-tools/cli)ï¼š** ç¡®ä¿æ‚¨å·²å®‰è£…æœ€æ–°ç‰ˆæœ¬çš„ Hyperlane CLIã€‚

  ```
  npm install -g @hyperlane-xyz/cli
  ```

- **[Anvil (foundry)](https://book.getfoundry.sh/getting-started/installation)ï¼š** ç”¨äºè¿è¡Œæœ¬åœ°é“¾ã€‚é€šè¿‡ä»¥ä¸‹å‘½ä»¤å®‰è£…ï¼š

  ```
  curl -L https://foundry.paradigm.xyz | bash
  ```

- **Node.js** (v18 æˆ–æ›´é«˜ç‰ˆæœ¬)

- **éƒ¨ç½²é’±åŒ…ç§é’¥**ï¼šæ‚¨éœ€è¦ä¸€ä¸ªæœ‰èµ„é‡‘çš„é’±åŒ…æ¥éƒ¨ç½²åˆçº¦ã€‚è¿™å°†ç”¨ä½œ HYP_KEYã€‚

  ```
  export HYP_KEY=<YOUR_PRIVATE_KEY>
  ```

## åˆ†æ­¥æŒ‡å—[â€‹](#step-by-step-guide "ç›´æ¥é“¾æ¥åˆ°åˆ†æ­¥æŒ‡å—")

### 1. ç¯å¢ƒè®¾ç½®

ä¸º Hyperlane é…ç½®åˆ›å»ºå·¥ä½œç›®å½•ï¼š[â€‹](#1-environment-setup-create-a-working-directory-for-the-hyperlane-configuration "ç›´æ¥é“¾æ¥åˆ° 1. ç¯å¢ƒè®¾ç½®ï¼šä¸º Hyperlane é…ç½®åˆ›å»ºå·¥ä½œç›®å½•ï¼š")

```
mkdir hyperlane-local-test && cd hyperlane-local-test
```

### 2. å¯åŠ¨ä¸¤ä¸ªä¸åŒçš„ Anvil èŠ‚ç‚¹[â€‹](#2-start-two-distinct-anvil-nodes "ç›´æ¥é“¾æ¥åˆ° 2. å¯åŠ¨ä¸¤ä¸ªä¸åŒçš„ Anvil èŠ‚ç‚¹")

æˆ‘ä»¬å°†è¿è¡Œä¸¤ä¸ªå…·æœ‰å”¯ä¸€é“¾ ID çš„ Anvil èŠ‚ç‚¹ã€‚

- åœ¨ç¬¬ä¸€ä¸ªç»ˆç«¯ä¸­ï¼Œå¯åŠ¨ç¬¬ä¸€ä¸ª Anvil èŠ‚ç‚¹ï¼š

  ```
  anvil --port 8545 --chain-id 31337 --block-time 1
  ```

  - è¿è¡Œåœ¨ `http://localhost:8545`ã€‚
  - é“¾ IDï¼š`31337`ã€‚

- åœ¨æ–°ç»ˆç«¯ä¸­ï¼Œå¯åŠ¨ç¬¬äºŒä¸ª Anvil èŠ‚ç‚¹ï¼š

  ```
  anvil --port 8546 --chain-id 31338 --block-time 1
  ```

  - è¿è¡Œåœ¨ `http://localhost:8546`ã€‚
  - é“¾ IDï¼š`31338`ã€‚

### 3. åˆå§‹åŒ– Hyperlane Registry (æ³¨å†Œè¡¨)[â€‹](#3-initialize-the-hyperlane-registry "ç›´æ¥é“¾æ¥åˆ° 3. åˆå§‹åŒ– Hyperlane Registry")

åœ¨æ–°ç»ˆç«¯ä¸­ï¼Œä½¿ç”¨ Hyperlane CLI ä¸ºä¸¤ä¸ª Anvil èŠ‚ç‚¹åˆ›å»ºé…ç½®ï¼š

```
hyperlane registry init
```

æŒ‰ç…§æç¤ºè®¾ç½® `anvilnode1`ã€‚CLI ä¼šè¯¢é—®æ‚¨çš„é“¾è¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…æ‹¬ chainId å’Œ RPC URLsã€‚å¯¹ `anvilnode2` é‡å¤æ­¤è¿‡ç¨‹ã€‚

æ­¤è¿‡ç¨‹å°†åœ¨ `$HOME/.hyperlane/chains/anvilnode1` å’Œ `$HOME/.hyperlane/chains/anvilnode2` ä¸‹åˆ›å»º `metadata.yaml` æ–‡ä»¶ã€‚

å…ƒæ•°æ®ç¤ºä¾‹ï¼š

- **anvilnode1**

```
chainId: 31337displayName: Anvilnode1domainId: 31337isTestnet: truename: anvilnode1nativeToken:  decimals: 18  name: ETH  symbol: ETHprotocol: ethereumrpcUrls:  - http: http://localhost:8545
```

- **anvilnode2**

```
chainId: 31338displayName: Anvilnode2domainId: 31338isTestnet: truename: anvilnode2nativeToken:  decimals: 18  name: ETH  symbol: ETHprotocol: ethereumrpcUrls:  - http: http://localhost:8546
```

### 4. éƒ¨ç½²æ ¸å¿ƒåˆçº¦[â€‹](#4-deploy-core-contracts "ç›´æ¥é“¾æ¥åˆ° 4. éƒ¨ç½²æ ¸å¿ƒåˆçº¦")

æˆ‘ä»¬å°†é…ç½®å¹¶éƒ¨ç½² Hyperlane æ ¸å¿ƒåˆçº¦ã€‚

<Check>
  æ‚¨éœ€è¦éƒ¨ç½²é’±åŒ…ç§é’¥æ¥éƒ¨ç½²æ ¸å¿ƒåˆçº¦ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ `export HYP_KEY='<YOUR_PRIVATE_KEY>'` å°†ç§é’¥è®¾ç½®ä¸ºç¯å¢ƒå˜é‡ã€‚
</Check>

```
hyperlane core init
```

éƒ¨ç½²é…ç½®å°†ä¿å­˜åˆ° `./configs/core-config.yaml`ã€‚

æ¥ä¸‹æ¥ï¼Œéƒ¨ç½²æ ¸å¿ƒåˆçº¦ï¼š

```
hyperlane core deploy
```

æŒ‰ç…§æç¤ºé€‰æ‹© `anvilnode1`ã€‚CLI å°†éƒ¨ç½² Mailbox (æ¶ˆæ¯é‚®ç®±)ã€Interchain Security Modules (è·¨é“¾å®‰å…¨æ¨¡å—) å’Œå…¶ä»–å¿…éœ€çš„åˆçº¦ã€‚å¯¹ `anvilnode2` é‡å¤æ­¤è¿‡ç¨‹ã€‚

å®Œæˆåï¼Œæ‚¨å°†åœ¨ `$HOME/.hyperlane/chains/anvilnode1` å’Œ `$HOME/.hyperlane/chains/anvilnode2` ä¸­æ‰¾åˆ° `addresses.yaml`ï¼Œå…¶ä¸­åŒ…å«å·²éƒ¨ç½²çš„åˆçº¦åœ°å€ã€‚

<Check>
  æ‚¨åº”è¯¥èƒ½å¤Ÿåœ¨è¿è¡Œæœ¬åœ°èŠ‚ç‚¹çš„ç»ˆç«¯ä¸­çœ‹åˆ°åˆçº¦éƒ¨ç½²çš„æ¶ˆæ¯ã€‚
</Check>

### 5. å‘é€æµ‹è¯•æ¶ˆæ¯[â€‹](#5-send-a-test-message "ç›´æ¥é“¾æ¥åˆ° 5. å‘é€æµ‹è¯•æ¶ˆæ¯")

ä½¿ç”¨ Hyperlane CLI ä» `anvilnode1` å‘ `anvilnode2` å‘é€æ¶ˆæ¯ã€‚

```
hyperlane send message --relay
```

CLI å°†æç¤ºæ‚¨æä¾›æºé“¾ï¼ˆ`anvilnode1`ï¼‰å’Œç›®æ ‡é“¾ï¼ˆ`anvilnode2`ï¼‰ã€‚

<Check>
  å¯¹äºæœ¬åœ°æµ‹è¯•ï¼Œ`--relay` æ ‡å¿—ä¼šè‡ªåŠ¨å°†æ¶ˆæ¯ä¸­ç»§åˆ°ç›®æ ‡é“¾ã€‚
</Check>

å‘é€æ¶ˆæ¯åï¼Œæ£€æŸ¥ä»¥ä¸‹å†…å®¹ï¼š

- Validator (éªŒè¯å™¨) æ—¥å¿—ï¼šæŸ¥æ‰¾è¡¨æ˜å·²ç”Ÿæˆå¹¶å­˜å‚¨ç­¾åçš„æ¡ç›®ã€‚
- Relayer (ä¸­ç»§å™¨) æ—¥å¿—ï¼šæŸ¥æ‰¾æˆåŠŸçš„å…ƒæ•°æ®æ£€ç´¢å’Œæ¶ˆæ¯å¤„ç†ã€‚
- Anvil æ—¥å¿—ï¼šç¡®ä¿åŒºå—å·²æŒ–æ˜ä»¥å¤„ç†äº¤æ˜“ã€‚

<Check>
  ğŸ‰ æ‚¨å·²æˆåŠŸä½¿ç”¨ Hyperlane åœ¨ä¸¤ä¸ªæœ¬åœ° Anvil èŠ‚ç‚¹ä¹‹é—´å‘é€äº†æ¶ˆæ¯ï¼
</Check>

## æ•…éšœæ’é™¤[â€‹](#troubleshooting "ç›´æ¥é“¾æ¥åˆ°æ•…éšœæ’é™¤")

1. "Could not fetch metadata" è­¦å‘Šï¼š

   - **åŸå› ï¼š** å½“ relayer (ä¸­ç»§å™¨) æ— æ³•æ£€ç´¢å¤„ç†æ¶ˆæ¯æ‰€éœ€çš„ validator (éªŒè¯å™¨) ç­¾åæ—¶å‘ç”Ÿã€‚å¸¸è§åŸå› ï¼š

     - validator (éªŒè¯å™¨) å¯†é’¥ç¼ºä¹æµ‹è¯•ç½‘èµ„é‡‘ã€‚
     - validator (éªŒè¯å™¨) å°šæœªå®£å¸ƒå…¶å­˜å‚¨ä½ç½®ã€‚

   - **è§£å†³æ–¹æ¡ˆï¼š**

     - ç¡®ä¿ validators (éªŒè¯å™¨) å·²å®£å¸ƒå…¶å­˜å‚¨ä½ç½®ã€‚æ£€æŸ¥ validator (éªŒè¯å™¨) æ—¥å¿—ä¸­çš„æ¶ˆæ¯ï¼Œå¦‚ï¼š`Validator has announced signature storage location, locations: ["file:///tmp/hyperlane-validator-signatures-local"].`
     - éªŒè¯æ¯ä¸ª validator (éªŒè¯å™¨) éƒ½æœ‰å”¯ä¸€çš„ç­¾åå­˜å‚¨è·¯å¾„ï¼ˆ`--checkpointSyncer.path`ï¼‰ä»¥é˜²æ­¢è¦†ç›–ã€‚
     - ç¡®è®¤ relayer (ä¸­ç»§å™¨) å¯¹å­˜å‚¨è·¯å¾„å…·æœ‰è¯»å–æƒé™ã€‚

2. æ¶ˆæ¯è¶…æ—¶ï¼š

   - **åŸå› ï¼š** Anvil é»˜è®¤ä¸è‡ªåŠ¨æŒ–æ˜åŒºå—ï¼Œå¯¼è‡´ validators (éªŒè¯å™¨) æˆ– relayers (ä¸­ç»§å™¨) æ— é™æœŸç­‰å¾…æ–°åŒºå—ã€‚
   - **è§£å†³æ–¹æ¡ˆï¼š** ç¡®ä¿åœ¨å¯åŠ¨ Anvil æ—¶ä½¿ç”¨ `--block-time 1` æ ‡å¿—ï¼Œä»¥æ¯ç§’è‡ªåŠ¨æŒ–æ˜åŒºå—ã€‚

3. Validator (éªŒè¯å™¨) ä¸åŒ¹é…æˆ–é…ç½®é”™è¯¯ï¼š

   - **åŸå› ï¼š** ç›®æ ‡é“¾ä¸Šçš„ ISM é…ç½®ä¸æºé“¾ä½¿ç”¨çš„ validator (éªŒè¯å™¨) å¯†é’¥ä¸åŒ¹é…ã€‚
   - **è§£å†³æ–¹æ¡ˆï¼š** æ£€æŸ¥ ISM é…ç½®æ˜¯å¦åŒ…å«æ­£ç¡®çš„ validator (éªŒè¯å™¨) åœ°å€ã€‚Validator (éªŒè¯å™¨) æ—¥å¿—å¯å¸®åŠ©è¯†åˆ«å·²å®£å¸ƒçš„åœ°å€ã€‚